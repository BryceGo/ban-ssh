BAN-SSH.py

To use, do:
sudo python3 ban-ssh.py

To get help, do:
sudo python3 ban-ssh.py -h

The script should show the following help message:

usage: ban-ssh.py [-h] [-f FILE] [-d DATABASE] [-m MAX_ATTEMPTS] [-u UNBAN_LIMIT]

SSH monitoring program. Bans IP addresses based on the number of attempts and unbans after some time.

optional arguments:
  -h, --help            show this help message and exit
  -f FILE, --file FILE  the SSH auth.log file. Defaults to /var/log/auth.log
  -d DATABASE, --database DATABASE
                        the JSON database filename. Defaults to ./database
  -m MAX_ATTEMPTS, --max_attempts MAX_ATTEMPTS
                        maximum number of SSH login attempts before the ban. -1 for no ban. Default is 3
  -u UNBAN_LIMIT, --unban_limit UNBAN_LIMIT
                        Unbanning time in minutes. -1 for indefinite. Default is -1. Ban occurs for unban_limit^(number of bans). This means that
                        ban time increases exponentially in max_attempt increments until a successful login is detected
